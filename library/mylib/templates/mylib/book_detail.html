{% extends 'mylib/base.html' %}
{% load ratings %}
{% load mptt_tags %}

{% block content %}
    <h3>{{ book.title }}</h3>
    <img src="{{ book.cover.url }}">
    {% ratings book %}
    <p>Authors:
        <ul>{% for author in book.authors.all %}<li>{{ author.full_name }}</li>{% endfor %}</ul>
    <p>Genre:
        <ul>{% for g in book.genre.all %}<li>{{ g }}</li>{% endfor %}</ul>
    </p>
    <p>Year: {{ book.year }}</p>
    <p>Count of pages: {{ book.number_page }}</p>
    <p>Publisher: {{ book.publishing }}</p>
    <p>Description: {{ book.description }}</p>

    <hr>
    <ul>
        {% recursetree comments %}
            <div class="comment">
                <li>
                    <strong>{{ node.author }}</strong>
                    <div class="date">{{ node.created_at }}</div>
                    <p>{{ node.text|linebreaks }}</p>

                    {% if not node.is_leaf_node %}
                        <ul>
                            {{ children }}
                        </ul>
                    {% endif %}
                </li>
            </div>
        {% endrecursetree %}
    </ul>
    <div class="row">
        <div class="col-lg-6 col-md-8 col-sm-10">
          <form method="post">
            {% csrf_token %}
              {{ form.as_p }}
            <button type="submit" class="btn btn-success">Comment</button>
          </form>
        </div>
      </div>
{% endblock %}